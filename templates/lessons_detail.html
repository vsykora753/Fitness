{% extends 'base.html' %}
{% load static %}

{% block title %}{{ lesson.title }} | Fitness Lektor{% endblock %}

{% block content %}
<div class="lesson-detail">
    <h1>{{ lesson.title }}</h1>
    
    <div class="lesson-info-detail">
        <p class="lesson-description">{{ lesson.description }}</p>
        
        <div class="lesson-meta">
            <div class="meta-item">
                <strong>Délka lekce:</strong> {{ lesson.duration }} minut
            </div>
            <div class="meta-item">
                <strong>Kapacita:</strong> {{ lesson.capacity }} osob
            </div>
            <div class="meta-item">
                <strong>Cena:</strong> {{ lesson.price }} Kč
            </div>
        </div>

        <div class="instructor-info">
            <h3>Lektor</h3>
            <p>{{ lesson.instructor.get_full_name }}</p>
        </div>
    </div>

    <div class="available-slots">
        <h2>Dostupné termíny</h2>
        {% if time_slots %}
        <div class="time-slots-grid">
            {% for slot in time_slots %}
            <div class="time-slot-card">
                <div class="slot-date">{{ slot.start_time|date:"j. n. Y" }}</div>
                <div class="slot-time">{{ slot.start_time|time:"H:i" }}</div>
                <div class="slot-availability">
                    {% with booked_count=slot.booking_set.count %}
                    Volná místa: {{ lesson.capacity|add:"-"|add:booked_count }} z {{ lesson.capacity }}
                    {% endwith %}
                </div>
                {% if user.is_authenticated and not user.is_instructor %}
                <a href="{% url 'booking_create' slot.id %}" class="btn">Rezervovat</a>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        {% else %}
        <p>V současné době nejsou k dispozici žádné termíny.</p>
        {% endif %}
    </div>
</div>
{% endblock %}