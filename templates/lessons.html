{% extends 'base.html' %}
{% load static %}

{% block title %}Lekce | Fitness Lektor{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/calendar.css' %}">
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/calendar.js' %}"></script>
{% endblock %}

{% block body_class %}no-hero{% endblock %}

{% block content %}
<h1>Rozvrh lekcí - rezervace</h1>

<div id="category-tabs" class="category-tabs">
    <button class="category-tab active" data-category="all">Vše</button>
    {% for key, label in categories %}
    <button class="category-tab" data-category="{{ key }}">{{ label }}</button>
    {% endfor %}
</div>

<div class="calendar-controls">
    <button id="prevMonth" class="btn">&lt; Předchozí</button>
    <h2 id="currentMonth"></h2>
    <button id="nextMonth" class="btn">Další &gt;</button>
</div>

<div class="calendar">
    <div class="calendar-header">
        <div>Po</div>
        <div>Út</div>
        <div>St</div>
        <div>Čt</div>
        <div>Pá</div>
        <div>So</div>
        <div>Ne</div>
    </div>
    <div id="calendar-days" class="calendar-days">
        <!-- Dny budou dynamicky generovány JavaScriptem -->
    </div>
</div>

<!-- Šablona pro zobrazení lekcí v buňce kalendáře -->
<template id="lessons-popup-template">
    <div class="lessons-popup">
        <div class="lesson-item">
            <div class="lesson-time"></div>
            <div class="lesson-title"></div>
            <div class="lesson-instructor"></div>
            <div class="lesson-spots"></div>
        </div>
    </div>
</template>

<!-- Data pro JavaScript -->
{{ lessons_by_day|json_script:"lessons-by-day-data" }}
<script>
    // Načteme bezpečně serializovaná data
    const lessonsByDay = JSON.parse(document.getElementById('lessons-by-day-data').textContent || '{}');
    const lessonsData = {
        month: {{ current_month }},
        year: {{ current_year }},
        lessons: lessonsByDay
    };
    // base url pro detail lekce (např. /bookings/lesson/0/) - nahradíme poslední ID
    const lessonDetailBase = "{% url 'lesson_detail' 0 %}";

    
</script>



{% endblock %}
